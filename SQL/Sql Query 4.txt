--rank

create table Marks(stdname varchar(20), class_subject varchar(10),marks int)

insert into Marks values('Muthu','Maths',80),('Muthu','Science',70),('Muthu','English',65)
insert into Marks values('Shahbaz','Maths',68),('Shahbaz','Science',85),('Shahbaz','English',90)
insert into Marks Values('Sahithi','Maths',60),('Sahithi','Science',90),('Sahithi','English',64)

insert into Marks values('Shreya','Maths',68),('Shreya','Science',85),('Shreya','English',60)
select * from marks
update marks set marks=65 where stdname='Sahithi' and class_subject='English'

--query with row_number()
select stdname,class_subject,marks,ROW_NUMBER()over(order by marks desc)ranking from marks

--query with rank() -- skips the rank numbers whenever there is a tie(duplicate value)
select stdname,class_subject,marks,rank()over(order by marks desc)ranking from marks

--query with dense_rank() -- unlike rank(), this does not skip rank numbers
select stdname,class_subject,marks,dense_rank()over(order by marks desc)ranking from marks

--ranks with partitions
select stdname,class_subject,marks,rank()over(partition by class_subject order by marks desc)ranking from marks

select stdname,class_subject,marks,dense_rank()over(partition by class_subject order by marks desc)ranking from marks



--index
sp_help casetable

select * from casetable
update casetable set cid=1 where casename='Blue'
insert into casetable values(3,'Beige')

create unique clustered index idxcaseid on casetable(cid)

create clustered index idx2 on casetable(casename) -- not more than 1 clustered index is allowed/table

--drop index
drop index casetable.idxcaseid

--non-clustered index

create nonclustered index idxid on casetable(cid)

drop index casetable.idxid

--just clustered index
create clustered index idx1 on casetable(cid)
select * from casetable
where cid=3

--non clustered index on name column of the emp
create nonclustered index idxname on emp(empname)

select * from emp where empname like 'S%'

--filtered index
create index ixphone on emp(phone)
where phone is not null

create index idxdept on tblemployee(deptid)
where deptid is not null

select * from tblEmployee where deptid is not null

create table indexsample(sampleid int, sname varchar(20),sage int, city varchar(30))
insert into indexsample values(3,'aaa',3,'Pune'),(6,'bbb',15,'Mumbai'),(1,'ccc',32,'Kolkatta'),
(5,'ddd',21,'Chennai')

select * from indexsample
where city like 'K%'

create nonclustered index idxcity on indexsample(city)